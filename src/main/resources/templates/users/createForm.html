<!DOCTYPE html>
<html
    lang="fr"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout}"
>
    <head>
        <title>Créer un utilisateur</title>       
    </head>

    <body>
        <span layout:fragment="breadcrumb-current">Créer un utilisateur</span>

        <div layout:fragment="content">
            <div>
                <h1 class="text-2xl font-semibold text-granite-900 mb-6">Créer un nouveau utilisateur</h1>
                
                <form th:action="@{/users/create}" 
                    x-data="userForm"
                    x-cloak
                    th:object="${userForm}" 
                    method="post" class="space-y-6"
                >
                    <!-- Global errors -->
                    <div>
                        <ul th:if="${#fields.hasGlobalErrors()}">
                            <li class="text-red-600 text-sm mb-2" th:each="err : ${#fields.globalErrors()}" th:text="${err}"></li>
                        </ul>
                    </div>

                    <!-- Civilité -->
                    <div>
                        <label class="block text-sm font-medium text-granite-700 mb-2">Civilité</label>
                        <div class="flex gap-3">
                            <label class="flex-1 flex items-center gap-3 px-4 py-3 border border-granite-300 
                                rounded-lg cursor-pointer transition-all hover:bg-granite-50
                                has-checked:border-granite-600 has-checked:bg-granite-50"
                            >
                                <input 
                                    type="radio" 
                                    name="gender" 
                                    id="homme" 
                                    value="Homme" 
                                    x-model="ffields.gender"
                                    @blur="validateField('gender')"
                                    th:field="*{gender}"
                                    class="w-4 h-4 border-2 border-granite-300 rounded-full appearance-none cursor-pointer transition-all
                                        checked:border-granite-600 checked:border-[5px] 
                                        focus:outline-1 focus:outline-granite-400 focus:outline-offset-0"
                                />
                                <span class="text-sm font-medium text-granite-700">Homme</span>
                            </label>
                            <label class="flex-1 flex items-center gap-3 px-4 py-3 border border-granite-300 
                                rounded-lg cursor-pointer transition-all hover:bg-granite-50
                                has-checked:border-granite-600 has-checked:bg-granite-50"
                            >
                                <input 
                                    type="radio" 
                                    name="gender" 
                                    id="femme" 
                                    value="Femme" 
                                    x-model="ffields.gender"
                                    @blur="validateField('gender')"
                                    th:field="*{gender}"
                                    class="w-4 h-4 border-2 border-granite-300 rounded-full appearance-none cursor-pointer transition-all
                                        checked:border-granite-600 checked:border-[5px] 
                                        focus:outline-1 focus:outline-granite-400 focus:outline-offset-0"
                                />
                                <span class="text-sm font-medium text-granite-700">Femme</span>
                            </label>
                        </div>
                        <span th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}"></span>
                        <template x-if="!errors.gender.valid">
                            <span class="text-red-500 text-sm" x-text="errors.gender.message"></span>
                        </template>
                    </div>

                    <!-- Nom et Prénom -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="lastName" class="block text-sm font-medium text-granite-700 mb-1.5">Nom de famille</label>
                            <input 
                                type="text" 
                                id="lastName" 
                                x-model="ffields.lastName"
                                @blur="validateField('lastName')"
                                th:field="*{lastName}" 
                                placeholder="Diallo"
                                th:errorclass="border-red-300"
                                class="w-full px-3 py-2 border border-granite-300 rounded-lg 
                                    focus:outline-1 focus:outline-granite-400 focus:border-granite-300 
                                    transition-all"
                            />
                            <span th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}"></span>
                            <template x-if="!errors.lastName.valid">
                                <span class="text-red-500 text-sm" x-text="errors.lastName.message"></span>
                            </template>
                        </div>
                        <div>
                            <label for="firstName" class="block text-sm font-medium text-granite-700 mb-1.5">Prénom</label>
                            <input 
                                type="text" 
                                id="firstName" 
                                x-model="ffields.firstName"
                                @blur="validateField('firstName')"
                                th:field="*{firstName}"
                                placeholder="Alpha"
                                class="w-full px-3 py-2 border border-granite-300 rounded-lg 
                                    focus:outline-1 focus:outline-granite-400 focus:border-granite-300 
                                    transition-all"
                            />
                            <span th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}"></span>
                            <template x-if="!errors.firstName.valid">
                                <span class="text-red-500 text-sm" x-text="errors.firstName.message"></span>
                            </template>
                        </div>
                    </div>

                    <!-- Email et Téléphone -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="email" class="block text-sm font-medium text-granite-700 mb-1.5">Adresse électronique</label>
                            <input 
                                type="email" 
                                id="email" 
                                x-model="ffields.email"
                                @blur="validateField('email')"
                                th:field="*{email}" 
                                placeholder="alpha.diallo@exemple.com"
                                class="w-full px-3 py-2 border border-granite-300 rounded-lg 
                                    focus:outline-1 focus:outline-granite-400 focus:border-granite-300 
                                    transition-all"
                            />
                            <span th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></span>
                            <template x-if="!errors.email.valid">
                                <span class="text-red-500 text-sm" x-text="errors.email.message"></span>
                            </template>
                        </div>
                        <div>
                            <label for="telephone" class="block text-sm font-medium text-granite-700 mb-1.5">Numéro de téléphone</label>
                            <input 
                                type="tel" 
                                id="telephone" 
                                x-model="ffields.telephone"
                                @blur="validateField('telephone')"
                                th:field="*{telephone}" 
                                placeholder="+224 6 10 34 56 78"
                                class="w-full px-3 py-2 border border-granite-300 rounded-lg 
                                    focus:outline-1 focus:outline-granite-400 focus:border-granite-300 
                                    transition-all"
                            />
                            <span th:if="${#fields.hasErrors('telephone')}" th:errors="*{telephone}"></span>
                            <template x-if="!errors.telephone.valid">
                                <span class="text-red-500 text-sm" x-text="errors.telephone.message"></span>
                            </template>
                        </div>
                    </div>

                    <!-- Date de naissance -->
                    <div>
                        <label for="birthDate" class="block text-sm font-medium text-granite-700 mb-1.5">Date de naissance</label>
                        <input 
                            type="date" 
                            id="birthDate" 
                            x-model="ffields.birthDate"
                            @blur="validateField('birthDate')"
                            th:field="*{birthDate}" 
                            class="w-full px-3 py-2 border border-granite-300 rounded-lg 
                                focus:outline-1 focus:outline-granite-400 focus:border-granite-300 
                                transition-all"
                        />
                        <span th:if="${#fields.hasErrors('birthDate')}" th:errors="*{birthDate}"></span>
                        <template x-if="!errors.birthDate.valid">
                            <span class="text-red-500 text-sm" x-text="errors.birthDate.message"></span>
                        </template>
                    </div>

                    <!-- Boutons -->
                    <div class="flex items-center gap-3 pt-4">
                        <button 
                            type="submit"
                            :disabled="isInvalid"
                            :class="{ 'opacity-60 cursor-not-allowed': isInvalid }"
                            class="px-4 py-2 bg-granite-700 text-white rounded-lg
                            hover:bg-granite-800 transition-colors font-medium text-sm"
                        >
                            Créer l'utilisateur
                        </button>
                        <a 
                            th:href="@{/users}"
                            class="px-4 py-2 border border-granite-300 text-granite-700 rounded-lg hover:bg-granite-50 transition-colors font-medium text-sm"
                        >
                            Annuler
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <th:block layout:fragment="scripts">
            <script th:src="${asset.get('create-user')}"></script>
        </th:block>
    </body>
</html>